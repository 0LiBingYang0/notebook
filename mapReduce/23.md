## 分组 GroupingComparator

 ![image.png](https://upload-images.jianshu.io/upload_images/14466577-057ef4c6f0f92ff1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

* 输出结果：key--value:实体类--NullWritable

* orderInfo实体类
    * javaBean类:空构造，get和set，继承WritableComparable<OrderInfo>类，实现序列化和反序列化
   
    ![image.png](https://upload-images.jianshu.io/upload_images/14466577-7ca747d91fb7bced.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
    
    * compareTo()排序：第一要素--orderId;第二要素--price
    
   ![image.png](https://upload-images.jianshu.io/upload_images/14466577-7f52c1939ad89b86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


* 第一种：获取每个订单中的最大值

* (1)map端
   
   ![image.png](https://upload-images.jianshu.io/upload_images/14466577-3b58dfdfc1960b68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

* (2)reduce端

   ![image.png](https://upload-images.jianshu.io/upload_images/14466577-f0f8ea2ef2e75188.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

* (3)driver区

   ![image.png](https://upload-images.jianshu.io/upload_images/14466577-3fde5ab443a97d5b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
   
* 第二种:运用分组逻辑函数（重点）

* (1)map

* (2)reduce

* (3)gro


* 结果：
   ![image.png](https://upload-images.jianshu.io/upload_images/14466577-d533c1d1a9b2072f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
